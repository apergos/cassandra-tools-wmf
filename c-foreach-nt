#!/usr/bin/python


import logging
import sys

from cassandra.tools           import get_instances
from cassandra.tools.config    import LOG_LEVEL
from cassandra.tools.nodetool  import NodetoolOutputWriter
from cassandra.tools.output    import MAGENTA, CYAN


logging.basicConfig(level=LOG_LEVEL)


def main():
    for (i, instance) in enumerate(get_instances()):
        color = MAGENTA if (i % 2) == 0 else CYAN
        instance.nodetool.run(
            *sys.argv[1:],
            output=NodetoolOutputWriter(color, False, instance.name))


if __name__ == "__main__":
    main()
